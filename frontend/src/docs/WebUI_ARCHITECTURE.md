# RoleCraft WebUI æ¶æ„è®¾è®¡

## ğŸ“ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RoleCraft WebUI                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Header (å¯¼èˆªæ )                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ Logo â”‚  â”‚ æ¨¡å‹é€‰æ‹©å™¨  â”‚  â”‚ çŸ¥è¯†åº“   â”‚  â”‚ ç”¨æˆ·èœå• â”‚  â”‚  â”‚
â”‚  â”‚  â”‚      â”‚  â”‚             â”‚  â”‚ é€‰æ‹©å™¨   â”‚  â”‚          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            â”‚  â”‚                                           â”‚  â”‚
â”‚  â”‚  Sidebar   â”‚  â”‚           Chat Area                       â”‚  â”‚
â”‚  â”‚  (ä¾§è¾¹æ )  â”‚  â”‚         (ä¸»å¯¹è¯åŒºåŸŸ)                       â”‚  â”‚
â”‚  â”‚            â”‚  â”‚                                           â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”‚ + æ–°å»º  â”‚ â”‚  â”‚  â”‚  Welcome Screen                     â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  (æ¬¢è¿ç•Œé¢/å»ºè®®å¡ç‰‡)                 â”‚  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚ â”‚ æœç´¢   â”‚ â”‚  â”‚                                           â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚  Messages Container                 â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ ä»Šå¤©   â”‚ â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ â—‹ å¯¹è¯ 1â”‚ â”‚  â”‚  â”‚  â”‚ Message (AI)                  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ â—‹ å¯¹è¯ 2â”‚ â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  â”‚ Message (User)                â”‚  â”‚  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ æ˜¨å¤©   â”‚ â”‚  â”‚  â”‚  â”‚ Message (AI)                  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ â—‹ å¯¹è¯ 3â”‚ â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                                           â”‚  â”‚
â”‚  â”‚ â”‚ æ›´æ—©   â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”‚ â—‹ å¯¹è¯ 4â”‚ â”‚  â”‚  â”‚         ChatInput                 â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚  (è¾“å…¥æ¡†/é™„ä»¶/è¯­éŸ³/å‘é€)             â”‚  â”‚  â”‚
â”‚  â”‚            â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© ç»„ä»¶å±‚æ¬¡ç»“æ„

```
ChatWebUI (ä¸»é¡µé¢)
â”‚
â”œâ”€â”€ Header (å¯¼èˆªæ )
â”‚   â”œâ”€â”€ Logo
â”‚   â”œâ”€â”€ ModelSelector (æ¨¡å‹é€‰æ‹©)
â”‚   â”œâ”€â”€ KnowledgeSelector (çŸ¥è¯†åº“é€‰æ‹©)
â”‚   â”œâ”€â”€ ExportButton (å¯¼å‡ºæŒ‰é’®)
â”‚   â”œâ”€â”€ ThemeToggle (ä¸»é¢˜åˆ‡æ¢)
â”‚   â”œâ”€â”€ SettingsButton (è®¾ç½®)
â”‚   â””â”€â”€ UserMenu (ç”¨æˆ·èœå•)
â”‚
â”œâ”€â”€ Sidebar (ä¾§è¾¹æ )
â”‚   â”œâ”€â”€ NewChatButton (æ–°å»ºå¯¹è¯)
â”‚   â”œâ”€â”€ SearchInput (æœç´¢æ¡†)
â”‚   â”œâ”€â”€ ChatGroups (å¯¹è¯åˆ†ç»„)
â”‚   â”‚   â”œâ”€â”€ Today (ä»Šå¤©)
â”‚   â”‚   â”œâ”€â”€ Yesterday (æ˜¨å¤©)
â”‚   â”‚   â””â”€â”€ Earlier (æ›´æ—©)
â”‚   â””â”€â”€ CollapseButton (æŠ˜å æŒ‰é’®)
â”‚
â””â”€â”€ ChatArea (å¯¹è¯åŒºåŸŸ)
    â”‚
    â”œâ”€â”€ WelcomeScreen (æ¬¢è¿ç•Œé¢) [æ— å¯¹è¯æ—¶æ˜¾ç¤º]
    â”‚   â”œâ”€â”€ WelcomeIcon
    â”‚   â”œâ”€â”€ WelcomeTitle
    â”‚   â”œâ”€â”€ WelcomeSubtitle
    â”‚   â””â”€â”€ SuggestionCards (å»ºè®®å¡ç‰‡)
    â”‚
    â””â”€â”€ MessagesView (æ¶ˆæ¯è§†å›¾) [æœ‰å¯¹è¯æ—¶æ˜¾ç¤º]
        â”œâ”€â”€ MessagesContainer (æ¶ˆæ¯å®¹å™¨)
        â”‚   â””â”€â”€ Message[] (æ¶ˆæ¯åˆ—è¡¨)
        â”‚       â”œâ”€â”€ Avatar (å¤´åƒ)
        â”‚       â”œâ”€â”€ Content (å†…å®¹)
        â”‚       â”‚   â””â”€â”€ ReactMarkdown (Markdown æ¸²æŸ“)
        â”‚       â”‚       â”œâ”€â”€ Code (ä»£ç é«˜äº®)
        â”‚       â”‚       â”œâ”€â”€ Math (LaTeX å…¬å¼)
        â”‚       â”‚       â””â”€â”€ Table (è¡¨æ ¼)
        â”‚       â”œâ”€â”€ Timestamp (æ—¶é—´æˆ³)
        â”‚       â””â”€â”€ Actions (æ“ä½œæ )
        â”‚           â”œâ”€â”€ Edit (ç¼–è¾‘)
        â”‚           â”œâ”€â”€ Regenerate (é‡æ–°ç”Ÿæˆ)
        â”‚           â”œâ”€â”€ Copy (å¤åˆ¶)
        â”‚           â””â”€â”€ Rate (è¯„åˆ†)
        â”‚
        â””â”€â”€ ChatInput (è¾“å…¥æ¡†)
            â”œâ”€â”€ Textarea (æ–‡æœ¬è¾“å…¥)
            â”œâ”€â”€ Preview (Markdown é¢„è§ˆ)
            â”œâ”€â”€ AttachButton (é™„ä»¶)
            â”œâ”€â”€ VoiceButton (è¯­éŸ³)
            â”œâ”€â”€ MarkdownToggle (Markdown åˆ‡æ¢)
            â”œâ”€â”€ SendButton (å‘é€)
            â””â”€â”€ CharCounter (å­—ç¬¦è®¡æ•°)
```

---

## ğŸ”„ æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User Action   â”‚
â”‚  (ç”¨æˆ·æ“ä½œ)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ChatInput     â”‚
â”‚  (è¾“å…¥ç»„ä»¶)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  handleSend     â”‚
â”‚  (å‘é€å¤„ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  useChatStore   â”‚
â”‚  (çŠ¶æ€ç®¡ç†)      â”‚
â”‚  - sendMessage  â”‚
â”‚  - appendMessageâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    chatApi      â”‚
â”‚  (API è°ƒç”¨)      â”‚
â”‚  - streamMessageâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend API   â”‚
â”‚  (åç«¯æ¥å£)      â”‚
â”‚  /chat/:id/streamâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Stream Responseâ”‚
â”‚  (æµå¼å“åº”)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  updateMessage  â”‚
â”‚  (æ›´æ–°æ¶ˆæ¯)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Message      â”‚
â”‚  (æ¶ˆæ¯ç»„ä»¶)      â”‚
â”‚  (é‡æ–°æ¸²æŸ“)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ çŠ¶æ€ç®¡ç†

### Zustand Store ç»“æ„

```typescript
interface ChatState {
  // æ•°æ®
  sessions: ChatSession[];        // ä¼šè¯åˆ—è¡¨
  currentSession: ChatSession | null;  // å½“å‰ä¼šè¯
  messages: Message[];            // æ¶ˆæ¯åˆ—è¡¨
  
  // çŠ¶æ€
  isLoading: boolean;             // åŠ è½½çŠ¶æ€
  isStreaming: boolean;           // æµå¼å“åº”ä¸­
  error: string | null;           // é”™è¯¯ä¿¡æ¯
  
  // æ“ä½œ
  fetchSessions: () => Promise<void>;
  createSession: (roleId, title, mode) => Promise<ChatSession>;
  fetchSession: (id) => Promise<void>;
  sendMessage: (content) => Promise<void>;
  sendStreamMessage: (content) => Promise<void>;
  // ...
}
```

### ç»„ä»¶æœ¬åœ°çŠ¶æ€

```typescript
// ChatWebUI ç»„ä»¶
const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);
const [isDarkTheme, setIsDarkTheme] = useState(false);
const [selectedModel, setSelectedModel] = useState('qwen-plus');
const [selectedKnowledge, setSelectedKnowledge] = useState('none');

// ChatInput ç»„ä»¶
const [value, setValue] = useState('');
const [showPreview, setShowPreview] = useState(false);
const [height, setHeight] = useState(56);

// Message ç»„ä»¶
const [isEditing, setIsEditing] = useState(false);
const [editContent, setEditContent] = useState(content);

// Sidebar ç»„ä»¶
const [searchQuery, setSearchQuery] = useState('');
const [editingId, setEditingId] = useState<string | null>(null);
const [editTitle, setEditTitle] = useState('');
```

---

## ğŸ¨ æ ·å¼ç³»ç»Ÿ

### CSS å˜é‡ï¼ˆä¸»é¢˜ï¼‰

```css
:root {
  /* é¢œè‰²ç³»ç»Ÿ */
  --bg-primary: #ffffff;
  --bg-secondary: #f7f7f8;
  --bg-tertiary: #ececf1;
  --text-primary: #1a1a1a;
  --text-secondary: #6b6b6b;
  --accent-color: #6366f1;
  
  /* å°ºå¯¸ç³»ç»Ÿ */
  --sidebar-width: 280px;
  --header-height: 60px;
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 16px;
  
  /* é˜´å½±ç³»ç»Ÿ */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
}

[data-theme='dark'] {
  --bg-primary: #1a1a1a;
  --bg-secondary: #2d2d2d;
  --text-primary: #ffffff;
  /* ... */
}
```

### å“åº”å¼æ–­ç‚¹

```css
/* ç§»åŠ¨ç«¯ */
@media (max-width: 768px) {
  .webui-sidebar {
    position: fixed;
    transform: translateX(-100%);
  }
  
  .message-content {
    max-width: 85%;
  }
}

/* æ¡Œé¢ç«¯ */
@media (min-width: 769px) {
  .webui-sidebar {
    position: relative;
    transform: translateX(0);
  }
}
```

---

## ğŸ”Œ API é›†æˆ

### ä¸»è¦ API ç«¯ç‚¹

```typescript
// ä¼šè¯ç®¡ç†
GET    /api/v1/chat-sessions          // è·å–ä¼šè¯åˆ—è¡¨
POST   /api/v1/chat-sessions          // åˆ›å»ºä¼šè¯
GET    /api/v1/chat-sessions/:id      // è·å–ä¼šè¯è¯¦æƒ…
DELETE /api/v1/chat-sessions/:id      // åˆ é™¤ä¼šè¯
PUT    /api/v1/chat-sessions/:id/title // æ›´æ–°æ ‡é¢˜
POST   /api/v1/chat-sessions/:id/archive // å½’æ¡£

// æ¶ˆæ¯
POST   /api/v1/chat/:id/complete      // å‘é€æ¶ˆæ¯ï¼ˆæ™®é€šï¼‰
POST   /api/v1/chat/:id/stream        // å‘é€æ¶ˆæ¯ï¼ˆæµå¼ï¼‰
PUT    /api/v1/chat/:id/messages/:mid // ç¼–è¾‘æ¶ˆæ¯
POST   /api/v1/chat/:id/messages/:mid/regenerate // é‡æ–°ç”Ÿæˆ
POST   /api/v1/chat/messages/:id/rate // è¯„åˆ†

// å¯¼å‡º
POST   /api/v1/chat-sessions/:id/export // å¯¼å‡ºå¯¹è¯
```

### API è°ƒç”¨æµç¨‹

```
Component Action
    â†“
Event Handler (handleSendMessage)
    â†“
Store Action (sendStreamMessage)
    â†“
API Call (chatApi.streamMessage)
    â†“
HTTP Request (fetch)
    â†“
Backend API
    â†“
Stream Response (SSE)
    â†“
Chunk Handler (onChunk)
    â†“
Store Update (updateLastMessage)
    â†“
Component Re-render (Message)
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. æ¸²æŸ“ä¼˜åŒ–

```typescript
// ä½¿ç”¨ useMemo é¿å…é‡å¤è®¡ç®—
const groupedSessions = useMemo(() => {
  // åˆ†ç»„é€»è¾‘
}, [sessions]);

const filteredGroups = useMemo(() => {
  // è¿‡æ»¤é€»è¾‘
}, [groupedSessions, searchQuery]);
```

### 2. æ»šåŠ¨ä¼˜åŒ–

```typescript
// è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
const messagesEndRef = useRef<HTMLDivElement>(null);

useEffect(() => {
  messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
}, [messages]);
```

### 3. è¾“å…¥ä¼˜åŒ–

```typescript
// é˜²æŠ–è‡ªåŠ¨è°ƒæ•´é«˜åº¦
useEffect(() => {
  if (textareaRef.current) {
    textareaRef.current.style.height = 'auto';
    const scrollHeight = textareaRef.current.scrollHeight;
    const newHeight = Math.min(Math.max(scrollHeight, MIN_HEIGHT), MAX_HEIGHT);
    textareaRef.current.style.height = `${newHeight}px`;
  }
}, [value]);
```

---

## ğŸ›¡ï¸ é”™è¯¯å¤„ç†

### é”™è¯¯è¾¹ç•Œ

```typescript
// Toast é”™è¯¯æç¤º
{error && (
  <div className="error-toast">
    <span>âš ï¸</span>
    <span>{error}</span>
    <button onClick={clearError}>Ã—</button>
  </div>
)}
```

### API é”™è¯¯å¤„ç†

```typescript
try {
  await chatApi.sendMessage(content);
} catch (error: any) {
  console.error('Failed to send message:', error);
  alert('å‘é€å¤±è´¥ï¼š' + error.message);
}
```

---

## ğŸ“Š æ–‡ä»¶ä¾èµ–å…³ç³»

```
ChatWebUI.tsx
â”œâ”€â”€ Sidebar.tsx
â”œâ”€â”€ Message.tsx
â”‚   â”œâ”€â”€ react-markdown
â”‚   â”œâ”€â”€ remark-gfm
â”‚   â”œâ”€â”€ remark-math
â”‚   â”œâ”€â”€ rehype-katex
â”‚   â””â”€â”€ rehype-highlight
â”œâ”€â”€ ChatInput.tsx
â”‚   â”œâ”€â”€ react-markdown
â”‚   â”œâ”€â”€ remark-gfm
â”‚   â”œâ”€â”€ remark-math
â”‚   â””â”€â”€ rehype-katex
â”œâ”€â”€ webui.css
â”‚   â””â”€â”€ katex.min.css
â”œâ”€â”€ chatApi.ts
â””â”€â”€ useChatStore.ts
```

---

## ğŸ¯ è®¾è®¡æ¨¡å¼

### 1. ç»„ä»¶ç»„åˆæ¨¡å¼

```typescript
// å°ç»„ä»¶ç»„åˆæˆå¤§ç»„ä»¶
<ChatWebUI>
  <Header />
  <Sidebar />
  <ChatArea>
    <WelcomeScreen /> æˆ– <MessagesView>
  </ChatArea>
</ChatWebUI>
```

### 2. çŠ¶æ€æå‡æ¨¡å¼

```typescript
// çŠ¶æ€ä¿å­˜åœ¨çˆ¶ç»„ä»¶ï¼Œé€šè¿‡ props ä¼ é€’
<Sidebar
  sessions={sessions}
  onSelectSession={handleSelectSession}
  onDeleteSession={handleDeleteSession}
/>
```

### 3. è‡ªå®šä¹‰ Hook æ¨¡å¼

```typescript
// ä½¿ç”¨ Zustand ç®¡ç†å…¨å±€çŠ¶æ€
const {
  sessions,
  currentSession,
  messages,
  sendStreamMessage,
} = useChatStore();
```

---

## ğŸ“ˆ å¯æ‰©å±•æ€§

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ–°ç»„ä»¶** â†’ åœ¨ `components/WebUI/` åˆ›å»º
2. **æ–°æ ·å¼** â†’ åœ¨ `webui.css` æ·»åŠ 
3. **æ–° API** â†’ åœ¨ `api/chat.ts` æ‰©å±•
4. **æ–°çŠ¶æ€** â†’ åœ¨ `chatStore.ts` æ·»åŠ 

### ä¸»é¢˜å®šåˆ¶

```css
/* åœ¨ webui.css ä¸­è¦†ç›–å˜é‡ */
:root {
  --accent-color: #your-color;
}
```

### æ’ä»¶ç³»ç»Ÿï¼ˆæœªæ¥ï¼‰

```typescript
// æ¶ˆæ¯æ’ä»¶
interface MessagePlugin {
  render: (message: Message) => React.ReactNode;
  actions: MessageAction[];
}

// æ³¨å†Œæ’ä»¶
registerPlugin(myPlugin);
```

---

## ğŸ”® æœªæ¥æ¶æ„æ¼”è¿›

### v1.0 (å½“å‰)
- âœ… åŸºç¡€å¯¹è¯åŠŸèƒ½
- âœ… Markdown/LaTeXæ”¯æŒ
- âœ… ä¸»é¢˜ç³»ç»Ÿ

### v2.0 (è®¡åˆ’)
- ğŸ”„ è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿å¯¹è¯ä¼˜åŒ–ï¼‰
- ğŸ”„ ç¦»çº¿æ”¯æŒï¼ˆPWAï¼‰
- ğŸ”„ æ’ä»¶ç³»ç»Ÿ

### v3.0 (æ„¿æ™¯)
- ğŸ”„ å®æ—¶åä½œ
- ğŸ”„ AI æ¨è
- ğŸ”„ å¤šæ¨¡æ€æ”¯æŒ

---

**æ¶æ„ç‰ˆæœ¬ï¼š** v1.0.0  
**æœ€åæ›´æ–°ï¼š** 2026-02-27
