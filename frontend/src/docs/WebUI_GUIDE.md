# RoleCraft WebUI 使用指南

## 📖 概述

RoleCraft WebUI 是一个现代化的 AI 对话界面，采用 Open WebUI 风格设计，提供流畅、直观的聊天体验。

---

## ✨ 主要特性

### 1. 现代化界面设计
- 🎨 **Open WebUI 风格** - 简洁、专业的视觉效果
- 🌓 **深色/浅色主题** - 一键切换，支持系统主题跟随
- 📱 **响应式布局** - 完美适配桌面和移动设备
- 🎭 **可折叠侧边栏** - 灵活调整界面布局

### 2. 对话管理
- 📋 **对话历史** - 自动保存所有对话记录
- 📂 **智能分组** - 按时间分组（今天/昨天/更早）
- 🔍 **搜索功能** - 快速查找历史对话
- ✏️ **重命名** - 自定义对话标题
- 📦 **归档/删除** - 灵活管理对话
- ➕ **新建对话** - 快速开始新对话

### 3. 消息展示
- 💬 **气泡式消息** - 清晰区分用户和 AI 消息
- 📝 **Markdown 渲染** - 完整支持 Markdown 语法
- 🎨 **代码高亮** - 支持 100+ 编程语言（Highlight.js）
- 📐 **LaTeX 公式** - 数学公式渲染（KaTeX）
- 📊 **表格支持** - 美观的表格展示
- 🎯 **悬停操作** - 复制、编辑、重新生成、评分

### 4. 输入体验
- ⌨️ **智能输入框** - 自动调整高度
- 📎 **附件上传** - 支持文件上传（开发中）
- 🎤 **语音输入** - 语音转文字（开发中）
- 👁️ **Markdown 预览** - 实时预览格式化效果
- ⚡ **快捷操作** - Enter 发送，Shift+Enter 换行

### 5. 高级功能
- 🤖 **模型切换** - 支持多种 AI 模型
- 📚 **知识库集成** - 连接私有知识库
- 📤 **对话导出** - 导出为 Markdown/JSON/PDF
- 👍 **消息评分** - 反馈 AI 回答质量
- 🔄 **重新生成** - 重新获取 AI 回复

---

## 🚀 快速开始

### 1. 安装依赖

```bash
cd rolecraft-ai/frontend
npm install react-markdown remark-gfm remark-math rehype-katex rehype-highlight katex highlight.js
```

### 2. 导入组件

```tsx
import ChatWebUI from './pages/ChatWebUI';

function App() {
  return <ChatWebUI initialRoleId="your-role-id" />;
}
```

### 3. 引入样式

```tsx
import './styles/webui.css';
```

### 4. 配置路由

```tsx
// 在路由配置中添加
<Route path="/chat" element={<ChatWebUI />} />
```

---

## 📖 使用指南

### 开始新对话

1. 点击左侧边栏的 **"+ 新建对话"** 按钮
2. 或直接在输入框输入消息（会自动创建新对话）
3. 或点击欢迎页面的建议卡片

### 切换对话

1. 在左侧边栏点击任意历史对话
2. 使用搜索框快速查找
3. 对话按时间自动分组

### 管理对话

**重命名对话：**
- 鼠标悬停在对话上
- 点击 ✏️ 图标
- 输入新标题，按 Enter 保存

**归档对话：**
- 鼠标悬停在对话上
- 点击 📦 图标
- 归档的对话可在"归档"分类查看

**删除对话：**
- 鼠标悬停在对话上
- 点击 🗑️ 图标
- 确认删除（不可恢复）

### 发送消息

**基本操作：**
- 在底部输入框输入内容
- 按 `Enter` 发送
- 按 `Shift+Enter` 换行

**Markdown 语法：**

```markdown
# 标题
**粗体** *斜体*
- 列表项
1. 有序列表
[链接](https://example.com)
![图片](image.png)
```

**代码块：**

````markdown
```javascript
const greeting = "Hello, World!";
console.log(greeting);
```
````

**LaTeX 公式：**

```markdown
行内公式：$E = mc^2$

块级公式：
$$
\int_{a}^{b} f(x) dx = F(b) - F(a)
$$
```

### 消息操作

**复制消息：**
- 鼠标悬停在消息上
- 点击 📋 图标

**编辑消息（仅用户）：**
- 鼠标悬停在消息上
- 点击 ✏️ 编辑
- 修改后保存

**重新生成（仅 AI）：**
- 鼠标悬停在 AI 消息上
- 点击 🔄 重新生成

**评分（仅 AI）：**
- 鼠标悬停在 AI 消息上
- 点击 👍 有用或 👎 无用

### 主题切换

**切换深色/浅色主题：**
- 点击右上角 🌙/☀️ 按钮
- 主题偏好会自动保存

**折叠侧边栏：**
- 点击顶部导航栏的 ⬅️/➡️ 按钮
- 或点击侧边栏底部的"折叠侧边栏"

### 导出对话

1. 点击右上角 📥 按钮
2. 选择导出格式：
   - **Markdown** (.md) - 文本格式，易于阅读
   - **JSON** (.json) - 结构化数据
   - **PDF** (.pdf) - 打印友好格式

---

## ⚙️ 配置选项

### 模型选择

在顶部导航栏选择 AI 模型：
- **Qwen Plus** - 平衡性能和速度
- **Qwen Max** - 最强性能
- **Qwen Turbo** - 最快速度
- **GPT-4** - OpenAI 最强模型
- **GPT-3.5** - OpenAI 快速模型

### 知识库选择

连接私有知识库增强 AI 回答：
- **无知识库** - 使用通用知识
- **产品知识库** - 产品信息和文档
- **技术文档** - 技术资料
- **客服手册** - 客服标准答案

---

## 🎨 自定义主题

### 修改主题色

编辑 `webui.css` 中的 CSS 变量：

```css
:root {
  /* 主色调 */
  --accent-color: #6366f1;
  --accent-hover: #4f46e5;
  --accent-light: #e0e7ff;
  
  /* 背景色 */
  --bg-primary: #ffffff;
  --bg-secondary: #f7f7f8;
  
  /* 文字颜色 */
  --text-primary: #1a1a1a;
  --text-secondary: #6b6b6b;
}
```

### 深色主题

```css
[data-theme='dark'] {
  --bg-primary: #1a1a1a;
  --bg-secondary: #2d2d2d;
  --text-primary: #ffffff;
}
```

---

## 📱 响应式支持

### 移动端适配

- **768px 以下** - 单列布局，侧边栏隐藏
- **768px 以上** - 双列布局，侧边栏显示
- **触摸优化** - 大按钮，易操作

### 移动端使用

1. 点击 ☰ 菜单按钮打开侧边栏
2. 滑动消息区域浏览历史
3. 输入框自动适应屏幕宽度

---

## 🔧 技术栈

- **React 18+** - UI 框架
- **TypeScript** - 类型安全
- **Zustand** - 状态管理
- **React Markdown** - Markdown 渲染
- **Remark** - Markdown 插件系统
- **Rehype** - HTML 处理
- **KaTeX** - LaTeX 公式渲染
- **Highlight.js** - 代码高亮

---

## 🐛 常见问题

### Q: Markdown 不渲染？
A: 确保已安装 `react-markdown` 和相关插件，并正确引入样式。

### Q: 代码高亮不工作？
A: 检查是否安装了 `rehype-highlight` 和 `highlight.js`，并引入样式文件。

### Q: LaTeX 公式显示异常？
A: 确保安装了 `rehype-katex` 和 `katex`，并引入 KaTeX 样式。

### Q: 对话历史不显示？
A: 检查 API 连接是否正常，确认已正确配置后端地址。

### Q: 流式响应不工作？
A: 检查后端是否支持 SSE（Server-Sent Events），确认 CORS 配置正确。

---

## 📝 最佳实践

### 1. 对话组织
- 为不同主题创建独立对话
- 定期归档或删除无用对话
- 使用有意义的对话标题

### 2. 提示词技巧
- 清晰、具体地描述需求
- 提供必要的上下文信息
- 使用示例说明期望格式

### 3. 性能优化
- 避免过长的对话（建议 <100 条消息）
- 定期清理不需要的对话
- 使用归档而非删除保留重要对话

### 4. 安全注意
- 不要上传敏感文件
- 不要分享个人隐私信息
- 导出对话时注意数据安全

---

## 🚧 开发中功能

- 📎 **文件上传** - 支持图片、文档上传
- 🎤 **语音输入** - 语音识别转文字
- 🔔 **消息通知** - 新回复提醒
- 📊 **对话统计** - 使用数据分析
- 🌐 **多语言** - 界面语言切换
- 🎨 **主题定制** - 更多主题配色

---

## 📞 技术支持

如有问题或建议，请：
1. 查看本使用指南
2. 检查控制台错误信息
3. 联系开发团队

---

**RoleCraft WebUI - 让 AI 对话更自然、更高效！** 🎭
