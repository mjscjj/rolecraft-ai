# RoleCraft AI - 产品需求文档 (PRD)

## 1. 产品概述

### 1.1 产品定位
RoleCraft AI 是一个企业级 AI 角色管理平台，允许用户创建、配置和管理具备特定技能和知识的 AI 数字员工。每个 AI 角色由提示词模板、技能集和知识库组成，可服务于不同业务场景。

### 1.2 目标用户
- 中小企业主：快速搭建 AI 团队
- 运营/营销人员：获取专业内容支持
- 法务/财务人员：获得专业咨询辅助
- 开发者：集成 AI 能力到自有系统

### 1.3 核心价值
- **开箱即用**：内置多种专业角色模板
- **灵活定制**：支持自定义角色和技能
- **知识增强**：支持文档上传构建专属知识库
- **多场景服务**：快速问答、深度任务、API 集成

---

## 2. 功能架构

```
RoleCraft AI
├── 空间管理 (Workspace)
│   ├── 个人空间
│   └── 企业/项目空间
├── 角色中心 (Role Center)
│   ├── 角色市场（内置模板）
│   ├── 我的角色
│   └── 角色编辑器
├── 知识库 (Knowledge Base)
│   ├── 文档管理
│   ├── 向量存储
│   └── 检索配置
├── 对话服务 (Chat Service)
│   ├── 快速问答
│   ├── 任务模式
│   └── 历史记录
└── API 平台 (API Platform)
    ├── API 密钥管理
    ├── 接口文档
    └── 用量统计
```

---

## 3. 核心功能详解

### 3.1 空间管理系统

#### 3.1.1 个人空间
- 默认创建一个个人空间
- 包含基础的角色创建限额
- 免费额度限制

#### 3.1.2 企业/项目空间
- 支持创建多个项目空间
- 每个空间独立管理角色和知识库
- 支持成员邀请和权限管理
- 团队协作功能

**空间信息字段：**
- 空间名称
- 空间类型（个人/企业/项目）
- 描述
- Logo
- 成员列表
- 创建时间

---

### 3.2 角色管理系统

#### 3.2.1 角色定义
一个 AI 角色由以下要素构成：

**基础信息：**
- 角色名称（如：营销助手、法务顾问）
- 角色头像/图标
- 角色描述（一句话介绍）
- 角色分类（营销、法务、技术、通用等）

**核心配置：**
- 系统提示词（System Prompt）- 定义角色身份和行为
- 欢迎语（首次对话展示）
- 模型选择（GPT-4、Claude、文心一言等）
- 温度参数（创造性 vs 确定性）

**技能配置（Skills）：**
- 技能是角色的能力模块
- 每个技能包含：名称、描述、触发条件、执行逻辑
- 支持内置技能和自定义技能

**知识库绑定：**
- 关联的文档集合
- 检索配置（Top-K、相似度阈值）

#### 3.2.2 内置角色模板

| 角色 | 分类 | 描述 | 核心能力 |
|------|------|------|----------|
| 智能助理 | 通用 | 全能型办公助手 | 日程管理、邮件撰写、信息整理 |
| 营销专家 | 营销 | 营销策划与内容创作 | 文案撰写、活动策划、市场分析 |
| 法务顾问 | 法律 | 合同审查与法律咨询 | 合同审核、法规查询、风险评估 |
| 财务助手 | 财务 | 财务报表与税务咨询 | 报表分析、税务规划、预算编制 |
| 技术支持 | 技术 | IT 问题诊断与解决 | 故障排查、代码审查、架构建议 |
| 前台接待 | 行政 | 客户接待与预约管理 | 访客登记、预约安排、电话接听 |
| HR 专员 | 人事 | 招聘与员工关系 | 简历筛选、面试安排、政策解答 |
| 产品经理 | 产品 | 需求分析与产品设计 | 用户调研、PRD 撰写、竞品分析 |

#### 3.2.3 角色编辑器
- 可视化提示词编辑器
- 变量插入（{{user_name}}、{{company}} 等）
- 实时预览和测试
- 版本历史管理

---

### 3.3 知识库系统

#### 3.3.1 文档管理
**支持的文档格式：**
- PDF（文本型和扫描型）
- Microsoft Word（.doc、.docx）
- 文本文件（.txt、.md）
- 网页链接（自动抓取）
- CSV/Excel（结构化数据）

**文档处理流程：**
1. 上传文档
2. 格式解析与文本提取
3. 文本分块（Chunking）
4. 向量化（Embedding）
5. 存储到向量数据库

**文档元数据：**
- 文档名称
- 文件类型
- 文件大小
- 上传时间
- 处理状态（处理中/已完成/失败）
- 分块数量
- 关联角色

#### 3.3.2 检索配置
- 检索模式：相似度检索 / 关键词检索 / 混合检索
- Top-K 设置（返回多少片段）
- 相似度阈值
- 重排序（Reranking）开关

---

### 3.4 对话系统

#### 3.4.1 快速问答模式
- 即时响应，适合简单咨询
- 不保留完整上下文（或保留短期）
- 快速输入框设计

#### 3.4.2 任务模式
- 支持多轮深度对话
- 完整上下文记忆
- 任务完成标记
- 可导出对话记录

#### 3.4.3 对话功能
- 消息编辑与重新生成
- 复制、分享对话
- 点赞/点踩反馈
- 引用知识库来源

---

### 3.5 API 平台

#### 3.5.1 API 密钥管理
- 生成/撤销 API 密钥
- 密钥权限设置
- 调用限额配置

#### 3.5.2 核心 API 接口
- `POST /api/v1/chat` - 发起对话
- `GET /api/v1/roles` - 获取角色列表
- `POST /api/v1/roles/{id}/chat` - 指定角色对话
- `POST /api/v1/documents` - 上传文档
- `GET /api/v1/documents/{id}/status` - 查询文档处理状态

---

## 4. 数据库设计

### 4.1 核心实体

```
User（用户）
├── id: UUID
├── email: String
├── name: String
├── avatar: String
├── created_at: Timestamp
└── workspaces: Workspace[]

Workspace（空间）
├── id: UUID
├── name: String
├── type: Enum(personal, team, enterprise)
├── owner_id: UUID
├── settings: JSON
├── created_at: Timestamp
├── members: WorkspaceMember[]
├── roles: Role[]
└── documents: Document[]

Role（角色）
├── id: UUID
├── workspace_id: UUID
├── name: String
├── avatar: String
├── description: Text
├── category: String
├── system_prompt: Text
├── welcome_message: Text
├── model_config: JSON
├── skills: Skill[]
├── documents: Document[]
├── is_template: Boolean
├── is_public: Boolean
├── created_at: Timestamp
└── updated_at: Timestamp

Document（文档）
├── id: UUID
├── workspace_id: UUID
├── name: String
├── file_type: String
├── file_size: Integer
├── file_path: String
├── status: Enum(pending, processing, completed, failed)
├── chunk_count: Integer
├── metadata: JSON
├── created_at: Timestamp
└── roles: Role[]

ChatSession（对话会话）
├── id: UUID
├── role_id: UUID
├── user_id: UUID
├── title: String
├── mode: Enum(quick, task)
├── messages: Message[]
├── created_at: Timestamp
└── updated_at: Timestamp

Message（消息）
├── id: UUID
├── session_id: UUID
├── role: Enum(user, assistant, system)
├── content: Text
├── sources: JSON
├── created_at: Timestamp
```

---

## 5. UI/UX 设计规范

### 5.1 设计语言
- **风格**：现代、简洁、专业
- **主色调**：深蓝（#1a365d）+ 青色（#00d4aa）
- **圆角**：8px 统一圆角
- **阴影**：柔和的多层阴影系统
- **字体**：Inter（英文）+ 思源黑体（中文）

### 5.2 页面结构

#### 5.2.1 整体布局
```
┌─────────────────────────────────────────────────────────────┐
│  Header: Logo | 空间切换 | 搜索 | 通知 | 用户头像              │
├──────────┬──────────────────────────────────────────────────┤
│          │                                                  │
│  Sidebar │              Main Content Area                   │
│          │                                                  │
│  - 首页   │              动态内容区域                         │
│  - 角色   │                                                  │
│  - 知识库 │                                                  │
│  - 对话   │                                                  │
│  - API    │                                                  │
│  - 设置   │                                                  │
│          │                                                  │
└──────────┴──────────────────────────────────────────────────┘
```

#### 5.2.2 响应式断点
- Desktop: 1280px+
- Tablet: 768px - 1279px
- Mobile: < 768px

---

## 6. 页面详细设计

### 6.1 首页仪表板 (Dashboard)

**布局：**
- 顶部统计卡片（角色数、文档数、对话次数）
- 左侧：最近使用角色快捷入口
- 右侧：最近对话列表
- 底部：推荐角色模板

**功能：**
- 快速开始新对话
- 继续历史对话
- 一键创建常用角色

### 6.2 角色中心 (Role Center)

**角色市场页：**
- 分类标签筛选
- 卡片网格展示
- 搜索功能
- 预览/使用按钮

**我的角色页：**
- 列表/网格视图切换
- 角色状态标识
- 编辑/删除/分享操作

**角色编辑器页：**
```
┌─────────────────────────────────────────────────────────────┐
│  步骤导航: 基础信息 → 提示词配置 → 技能选择 → 知识绑定 → 测试 │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  左侧编辑区                    │    右侧预览区               │
│  ──────────────────────────────┼────────────────────────    │
│  表单字段                      │    角色头像                 │
│  文本编辑器                    │    欢迎语展示               │
│  技能选择器                    │    对话模拟                 │
│  文档选择器                    │                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 知识库 (Knowledge Base)

**文档列表页：**
- 上传按钮（拖拽区域）
- 表格/卡片视图
- 状态筛选
- 批量操作

**文档详情页：**
- 文件信息
- 处理状态
- 内容预览（文本片段）
- 关联角色

### 6.4 对话界面 (Chat)

**角色选择器：**
- 下拉选择当前对话角色
- 快速切换

**对话区域：**
```
┌─────────────────────────────────────────────────────────────┐
│  角色头像 + 名称 + 设置按钮                                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────┐                                    │
│  │  用户消息            │                                    │
│  └─────────────────────┘                                    │
│                                                             │
│           ┌─────────────────────────────────────┐           │
│           │  AI 回复内容                         │           │
│           │  - 支持 Markdown                     │           │
│           │  - 可展开的来源引用                  │           │
│           │  - 操作按钮（复制、重新生成）        │           │
│           └─────────────────────────────────────┘           │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  输入框区域                                                  │
│  [附件] [输入框............................] [发送]          │
│  快捷提示标签: /总结 /翻译 /分析...                          │
└─────────────────────────────────────────────────────────────┘
```

### 6.5 API 管理页

- API 密钥列表
- 创建密钥对话框
- 调用统计图表
- 接口文档嵌入

---

## 7. 技术实现

### 7.1 技术栈

**前端：**
- React 18 + TypeScript
- Tailwind CSS + Headless UI
- TanStack Query（数据获取）
- Zustand（状态管理）
- React Router 6

**后端：**
- Go + Gin 框架
- GORM + PostgreSQL
- Redis（缓存、会话）
- MinIO/S3（文件存储）
- Milvus/Pinecone（向量数据库）

**AI/ML：**
- OpenAI/Claude API
- LangChain（编排框架）
- Embedding 模型（text-embedding-3）
- PDF 解析（pdfplumber、unstructured）

### 7.2 架构图

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   Web App   │──────│  API Gateway │──────│  Go Backend │
└─────────────┘      └─────────────┘      └──────┬──────┘
                                                  │
           ┌──────────┬──────────┬───────────────┼──────────┐
           │          │          │               │          │
      ┌────▼────┐ ┌───▼────┐ ┌──▼─────┐    ┌────▼────┐ ┌──▼─────┐
      │PostgreSQL│ │ Redis  │ │ MinIO  │    │Milvus   │ │OpenAI  │
      └─────────┘ └────────┘ └────────┘    └─────────┘ └────────┘
```

---

## 8. 开发计划

### 阶段一：MVP（4 周）
- [ ] 用户认证与空间管理
- [ ] 基础角色 CRUD
- [ ] 简单对话功能
- [ ] 单文档上传

### 阶段二：核心功能（4 周）
- [ ] 角色模板市场
- [ ] 知识库向量检索
- [ ] 多文档管理
- [ ] 对话历史记录

### 阶段三：进阶功能（4 周）
- [ ] 技能系统
- [ ] API 平台
- [ ] 团队协作
- [ ] 使用分析

### 阶段四：优化迭代（持续）
- [ ] 性能优化
- [ ] 更多模型支持
- [ ] 移动端适配
- [ ] 企业级功能

---

## 9. 附录

### 9.1 术语表
- **角色 (Role)**：配置好的 AI 数字员工
- **技能 (Skill)**：角色的特定能力模块
- **知识库 (Knowledge Base)**：向量化的文档集合
- **空间 (Workspace)**：项目/企业的隔离环境

### 9.2 参考资料
- OpenAI API 文档
- LangChain 文档
- 向量数据库选型指南
